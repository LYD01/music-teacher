echo ""
echo "ğŸ” Running Biome check on staged files..."
bunx lint-staged

echo ""
printf "ğŸ§¹ Format the entire src/ directory before committing? (y/N) "
exec < /dev/tty
read -r answer

if [ "$answer" = "y" ] || [ "$answer" = "Y" ]; then
  echo "Formatting src/..."
  bunx biome check --write --unsafe src/
  git add src/
  echo "âœ… src/ formatted and staged."
else
  echo "Skipping full format."
fi

echo ""
echo "ğŸ—ï¸  Running production build..."
if ! bun run build > /dev/null 2>&1; then
  echo ""
  echo "âŒ Production build failed. Fix build errors before committing."
  echo ""
  echo "  Run 'bun run build' to see the full error output."
  echo ""
  exit 1
fi
echo "âœ… Production build passed."
